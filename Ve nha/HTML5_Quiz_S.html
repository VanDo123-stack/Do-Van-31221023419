<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>HTML5 Quiz S - Form</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; background:#f5f7fb; margin:0; padding:20px; }
    header { text-align:center; padding:12px 0; }
    header img{ width:140px; display:block; margin:0 auto 8px; }
    .card { max-width:820px; margin:0 auto; background:white; padding:20px 28px; border-radius:8px;
            box-shadow:0 6px 18px rgba(0,0,0,0.06); }
    h1 { color:#0b4f8a; margin:0 0 14px; text-align:center; }
    form label { display:block; margin-top:14px; font-weight:600; color:#333; }
    .hint { font-weight:400; color:#666; font-size:13px; margin-top:4px; }
    input[type="text"], input[type="email"], input[type="url"], input[type="number"], input[type="date"], textarea {
      width:100%; padding:10px 12px; margin-top:6px; border:1px solid #ccd6e3; border-radius:6px; box-sizing:border-box;
      font-size:14px; background:#fff;
    }
    input[type="color"]{ width:60px; height:40px; padding:0; border:none; background:transparent; vertical-align:middle; }
    .row { display:flex; gap:12px; align-items:center; }
    .row .grow { flex:1; }
    .small { width:150px; }
    .actions { display:flex; gap:12px; margin-top:18px; }
    button {
      padding:10px 16px; border:none; border-radius:6px; background:#0b4f8a; color:#fff; cursor:pointer; font-weight:600;
    }
    button.secondary { background:#e0e6ef; color:#0b4f8a; }
    .error { color:#b00020; font-size:13px; margin-top:6px; display:none; }
    .ok { color:green; font-size:13px; margin-top:6px; display:none; }
  </style>
</head>
<body>
  <header>
    <img src="https://bit.ueh.edu.vn/wp-content/uploads/2017/06/BIT_logo.png" alt="UEH BIT Logo">
    <h1>HTML5 Quiz S - Form</h1>
  </header>

  <div class="card">
    <p class="hint">Tất cả các câu hỏi <strong>bắt buộc</strong>. Form sử dụng HTML5 + JavaScript để đảm bảo dữ liệu hợp lệ.</p>

    <form id="quizForm" novalidate>
      <!-- Câu 1: màu hợp lệ -->
      <label for="favcolor">Câu 1: Màu yêu thích (chỉ nhận màu hợp lệ)</label>
      <div class="row">
        <input type="color" id="favcolor" name="favcolor" required placeholder="#RRGGBB" aria-label="Chọn màu yêu thích">
        <!-- thêm ô text để người dùng có thể gõ mã màu hex và làm placeholder hiển thị -->
        <input type="text" id="favcolor_text" class="grow" name="favcolor_text"
               placeholder="Nhập mã màu (ví dụ: #ff6600) hoặc dùng bộ chọn màu" required>
      </div>
      <div id="errColor" class="error">Vui lòng chọn hoặc nhập màu hợp lệ (ví dụ #ff6600).</div>

      <!-- Câu 2: số nguyên >= 20 -->
      <label for="age">Câu 2: Nhập số nguyên (≥ 20)</label>
      <input type="number" id="age" name="age" required placeholder="Nhập số nguyên, tối thiểu 20" min="20" step="1" />
      <div id="errAge" class="error">Vui lòng nhập số nguyên ≥ 20 (không chấp nhận số thập phân).</div>

      <!-- Câu 3: email -->
      <label for="email">Câu 3: Email (hợp lệ)</label>
      <input type="email" id="email" name="email" required placeholder="ví dụ: tenban@gmail.com">
      <div id="errEmail" class="error">Vui lòng nhập địa chỉ email hợp lệ.</div>

      <!-- Câu 4: date -->
      <label for="birthdate">Câu 4: Ngày (nhập ngày hợp lệ)</label>
      <input type="date" id="birthdate" name="birthdate" required placeholder="Chọn ngày">
      <div id="errDate" class="error">Vui lòng chọn ngày hợp lệ.</div>

      <!-- Câu 5: URL -->
      <label for="website">Câu 5: Địa chỉ website (URL hợp lệ)</label>
      <input type="url" id="website" name="website" required placeholder="ví dụ: https://www.ueh.edu.vn">
      <div id="errUrl" class="error">Vui lòng nhập URL hợp lệ (bắt đầu bằng http:// hoặc https://).</div>

      <div class="actions">
        <button type="submit">Gửi</button>
        <button type="reset" class="secondary">Nhập lại</button>
      </div>

      <div id="submitMsg" class="ok">Form hợp lệ — dữ liệu sẵn sàng gửi (demo không gửi thật).</div>
    </form>
  </div>

  <script>
    // Helper: kiểm tra hex color (#RRGGBB or #RGB)
    function isValidHexColor(s) {
      return /^#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})$/.test(s);
    }

    // Lấy element
    const form = document.getElementById('quizForm');
    const favcolor = document.getElementById('favcolor');
    const favcolor_text = document.getElementById('favcolor_text');
    const errColor = document.getElementById('errColor');

    const age = document.getElementById('age');
    const errAge = document.getElementById('errAge');

    const email = document.getElementById('email');
    const errEmail = document.getElementById('errEmail');

    const birthdate = document.getElementById('birthdate');
    const errDate = document.getElementById('errDate');

    const website = document.getElementById('website');
    const errUrl = document.getElementById('errUrl');

    const submitMsg = document.getElementById('submitMsg');

    // Đồng bộ color input và text
    favcolor.addEventListener('input', () => {
      favcolor_text.value = favcolor.value;
      errColor.style.display = 'none';
    });
    favcolor_text.addEventListener('input', () => {
      const v = favcolor_text.value.trim();
      if (isValidHexColor(v)) {
        favcolor.value = v;
        favcolor_text.setCustomValidity('');
        errColor.style.display = 'none';
      } else {
        // vẫn cho phép gõ, nhưng nếu rời khỏi ô sẽ báo lỗi
        favcolor_text.setCustomValidity('Mã màu không hợp lệ');
      }
    });

    // Age: force integer (xóa phần thập phân khi gõ)
    age.addEventListener('input', () => {
      if (age.value === '') return;
      // loại bỏ ký tự không phải số và không phải dấu - (nếu cần)
      // giữ dấu chấm không cho nhập (so step=1)
      if (age.value.indexOf('.') !== -1) {
        // chuyển sang số nguyên (floor)
        age.value = Math.floor(Number(age.value));
      }
      errAge.style.display = 'none';
      age.setCustomValidity('');
    });

    // Validate URL simple: rely on browser but also check protocol
    function isValidUrlWithProtocol(u) {
      try {
        const url = new URL(u);
        return url.protocol === 'http:' || url.protocol === 'https:';
      } catch (e) {
        return false;
      }
    }

    // Form submit: kiểm tra các ràng buộc bổ sung
    form.addEventListener('submit', function (e) {
      e.preventDefault(); // demo: ngăn submit thực sự
      let ok = true;
      submitMsg.style.display = 'none';

      // Color: kiểm tra text value có hợp lệ hex hoặc color input có giá trị
      const colorVal = favcolor_text.value.trim() || favcolor.value;
      if (!isValidHexColor(colorVal)) {
        errColor.style.display = 'block';
        ok = false;
      } else {
        errColor.style.display = 'none';
      }

      // Age: phải >=20 và integer
      const ageVal = age.value;
      if (ageVal === '' || Number.isNaN(Number(ageVal)) || Number(ageVal) < 20 || (Number(ageVal) % 1 !== 0)) {
        errAge.style.display = 'block';
        ok = false;
      } else {
        errAge.style.display = 'none';
      }

      // Email: rely on browser validity
      if (!email.checkValidity()) {
        errEmail.style.display = 'block';
        ok = false;
      } else {
        errEmail.style.display = 'none';
      }

      // Date
      if (!birthdate.checkValidity()) {
        errDate.style.display = 'block';
        ok = false;
      } else {
        errDate.style.display = 'none';
      }

      // URL: additional check for protocol
      if (!website.checkValidity() || !isValidUrlWithProtocol(website.value.trim())) {
        errUrl.style.display = 'block';
        ok = false;
      } else {
        errUrl.style.display = 'none';
      }

      if (ok) {
        // mọi thứ hợp lệ - hiển thị thông báo (demo)
        submitMsg.style.display = 'block';
        // nếu bạn muốn gửi đi thật thì dùng: form.submit();
      } else {
        // cuộn tới đầu lỗi để người dùng thấy
        const firstErr = document.querySelector('.error[style*="block"]');
        if (firstErr) firstErr.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    });

    // Reset: ẩn thông báo lỗi
    form.addEventListener('reset', () => {
      setTimeout(() => {
        document.querySelectorAll('.error').forEach(el => el.style.display = 'none');
        submitMsg.style.display = 'none';
      }, 0);
    });
  </script>
</body>
</html>
